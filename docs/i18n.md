# Internationalization (i18n)

Sqlitch provides comprehensive internationalization support, allowing users to interact with the tool in their preferred language. This document covers the available languages, configuration, and technical details.

## Supported Languages

Sqlitch currently supports the following languages:

* **English** (en) - Default language, always available
* **German** (de_DE) - Complete translation
* **French** (fr_FR) - Complete translation  
* **Italian** (it_IT) - Complete translation

All translations are based on the original Perl Sqitch translations to ensure consistency across implementations.

## Setting Your Language

### Automatic Detection

Sqlitch automatically detects your system locale and displays messages in the appropriate language when available. If your preferred language is not available, Sqlitch gracefully falls back to English.

### Manual Configuration

You can explicitly set your language using environment variables:

#### Linux/macOS (Bash/Zsh)
```bash
# German
export LANG=de_DE.UTF-8
export LC_ALL=de_DE.UTF-8

# French  
export LANG=fr_FR.UTF-8
export LC_ALL=fr_FR.UTF-8

# Italian
export LANG=it_IT.UTF-8
export LC_ALL=it_IT.UTF-8

# English (explicit)
export LANG=en_US.UTF-8
export LC_ALL=en_US.UTF-8
```

#### Windows (Command Prompt)
```cmd
REM German
set LANG=de_DE.UTF-8

REM French
set LANG=fr_FR.UTF-8

REM Italian  
set LANG=it_IT.UTF-8
```

#### Windows (PowerShell)
```powershell
# German
$env:LANG = "de_DE.UTF-8"

# French
$env:LANG = "fr_FR.UTF-8"

# Italian
$env:LANG = "it_IT.UTF-8"
```

## Date and Time Formatting

Sqlitch automatically formats dates and times according to your locale settings:

* **ISO 8601** format for machine-readable output
* **RFC 2822** format for email-style timestamps
* **Locale-specific** formatting for user-friendly display

Examples of locale-aware formatting:

```bash
# English
sqlitch status
# Output: Deployed: Mon, 25 Dec 2023 15:30:45 +0000

# German  
LANG=de_DE.UTF-8 sqlitch status
# Output: Bereitgestellt: Mo, 25 Dez 2023 15:30:45 +0000

# French
LANG=fr_FR.UTF-8 sqlitch status  
# Output: Déployé : lun, 25 déc 2023 15:30:45 +0000
```

## Message Categories

Sqlitch translates several categories of messages:

### Error Messages
All error messages are translated, including:
* Configuration errors
* Database connection issues
* Plan file parsing errors
* Deployment failures

### User Prompts
Interactive prompts are localized:
* Confirmation dialogs (Yes/No)
* Input requests
* Warning messages

### Status Information
Status and informational messages:
* Deployment progress
* Change summaries
* Command completion messages

### Command Help
Command help text and usage information (planned for future release).

## Technical Details

### Translation System

Sqlitch uses Python's built-in `gettext` module for internationalization, providing:

* **Thread-safe** translation functions
* **Memory efficient** lazy loading of translation catalogs
* **Fallback support** when translations are missing
* **Parameter substitution** for dynamic messages

### Translation Functions

The i18n system provides three main translation functions:

* `__()` - Simple message translation
* `__x()` - Parameterized message translation  
* `__n()` - Plural form message translation

### File Structure

Translation files are organized as follows:

```
sqlitch/i18n/locale/
├── sqlitch.pot              # Template file
├── de_DE/LC_MESSAGES/
│   ├── sqlitch.po          # German source
│   └── sqlitch.mo          # German compiled
├── fr_FR/LC_MESSAGES/
│   ├── sqlitch.po          # French source  
│   └── sqlitch.mo          # French compiled
└── it_IT/LC_MESSAGES/
    ├── sqlitch.po          # Italian source
    └── sqlitch.mo          # Italian compiled
```

## Contributing Translations

We welcome contributions for additional languages! To contribute a translation:

1. **Extract messages** using the provided utility:
   ```bash
   python sqlitch/i18n/extract_messages.py
   ```

2. **Create a new language file** based on the template:
   ```bash
   cp sqlitch/i18n/locale/sqlitch.pot sqlitch/i18n/locale/xx_XX/LC_MESSAGES/sqlitch.po
   ```

3. **Translate the messages** in your `.po` file using a text editor or translation tool like [Poedit](https://poedit.net/).

4. **Compile the translation**:
   ```bash
   msgfmt -o sqlitch/i18n/locale/xx_XX/LC_MESSAGES/sqlitch.mo \
          sqlitch/i18n/locale/xx_XX/LC_MESSAGES/sqlitch.po
   ```

5. **Test your translation** by setting the locale and running Sqlitch commands.

6. **Submit a pull request** with your new translation files.

### Translation Guidelines

When translating Sqlitch messages:

* **Maintain consistency** with database terminology
* **Keep technical terms** in English when appropriate (e.g., "deploy", "revert")
* **Preserve parameter placeholders** like `{change}`, `{database}`, etc.
* **Test thoroughly** with actual Sqlitch commands
* **Follow locale conventions** for date/time formatting

## Troubleshooting

### Messages Not Translated

If messages appear in English despite setting your locale:

1. **Verify locale setting**:
   ```bash
   echo $LANG
   locale
   ```

2. **Check if translation exists**:
   ```bash
   ls sqlitch/i18n/locale/*/LC_MESSAGES/sqlitch.mo
   ```

3. **Verify locale format** (should be `xx_XX.UTF-8`)

4. **Try explicit locale setting**:
   ```bash
   LANG=de_DE.UTF-8 sqlitch status
   ```

### Date Formatting Issues

If dates don't format correctly for your locale:

1. **Install locale data** on your system:
   ```bash
   # Ubuntu/Debian
   sudo apt-get install locales-all
   
   # CentOS/RHEL
   sudo yum install glibc-locale-source glibc-langpack-*
   
   # macOS (usually pre-installed)
   ```

2. **Generate locale** if needed:
   ```bash
   sudo locale-gen de_DE.UTF-8
   ```

### Windows Locale Issues

On Windows, you may need to:

1. **Install language packs** through Windows Settings
2. **Use locale names** like `German_Germany.UTF-8` instead of `de_DE.UTF-8`
3. **Set both LANG and LC_ALL** environment variables

## Future Enhancements

Planned improvements to i18n support:

* **Additional languages** (Spanish, Portuguese, Japanese, Chinese)
* **Command help translation** for all commands
* **Configuration file comments** translation
* **Template message** translation
* **Pluralization rules** for complex languages
* **Right-to-left language** support

## Related Documentation

* [Configuration](configuration.md) - General Sqlitch configuration
* [Getting Started](getting-started.md) - Basic Sqlitch usage
* [Command Reference](commands.md) - All available commands